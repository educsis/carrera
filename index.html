<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>La Super Carrera de Edwin</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }
    .instrucciones {
      background-color: #fef08a;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    .pista {
      position: relative;
      height: 60px;
      margin: 10px 0;
      background: #eee;
      border: 1px solid #ccc;
      overflow: hidden;
    }
    .emoji {
      position: absolute;
      font-size: 40px;
      left: 0;
      top: 10px;
    }
    .controles {
      margin: 20px 0;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 24px;
      cursor: pointer;
    }
    #resultado {
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
    }
    #apuestaSeleccionada {
      font-size: 18px;
      color: #555;
    }
    #zonaCarrera, #reiniciarCarrera {
      display: none;
    }
  </style>
</head>
<body>

  <div id="instrucciones" class="instrucciones">
    <strong>ğŸ“£ Instrucciones:</strong><br>
    1. Elige tu emoji favorito para apostar.<br>
    2. Haz clic en â€œIniciar Carreraâ€ para comenzar.<br>
    3. Si tu emoji gana, Â¡felicidades! ğŸ‰<br>
    4. Â¡Captura tu victoria para ganar un premio! ğŸ’°
  </div>

  <h1>ğŸ La Super Carrera de Edwin</h1>
  <p id="textoEleccion">Elige un emoji para apostar y luego inicia la carrera.</p>

  <div id="eleccion">
    <div class="controles">
      <button data-emoji="ğŸ¢">ğŸ¢</button>
      <button data-emoji="ğŸ‡">ğŸ‡</button>
      <button data-emoji="ğŸ¦„">ğŸ¦„</button>
      <button data-emoji="ğŸ¶">ğŸ¶</button>
      <button data-emoji="ğŸ™">ğŸ™</button>
      <button data-emoji="ğŸ¦">ğŸ¦</button>
      <button data-emoji="ğŸµ">ğŸµ</button>
    </div>
    <div id="apuestaSeleccionada"></div>
    <button id="iniciarCarrera">Iniciar Carrera</button>
  </div>

  <div id="zonaCarrera">
    <div class="pista"><div class="emoji" data-emoji="ğŸ¢">ğŸ¢</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸ‡">ğŸ‡</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸ¦„">ğŸ¦„</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸ¶">ğŸ¶</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸ™">ğŸ™</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸ¦">ğŸ¦</div></div>
    <div class="pista"><div class="emoji" data-emoji="ğŸµ">ğŸµ</div></div>
  </div>

  <div id="resultado"></div>
  <button id="reiniciarCarrera">Reiniciar</button>

  <!-- ğŸµ Sonidos -->
  <audio id="sonidoGanar" src="win-sound.mp3"></audio>
  <audio id="sonidoPerder" src="lose-sound.mp3"></audio>
  <audio id="sonidoInicio" src="start.mp3"></audio>
  <audio id="sonidoCarrera" src="race-sound.mp3" loop></audio>

  <script>
    const botones = document.querySelectorAll('[data-emoji]');
    const iniciar = document.getElementById('iniciarCarrera');
    const reiniciar = document.getElementById('reiniciarCarrera');
    const apuestaSeleccionada = document.getElementById('apuestaSeleccionada');
    const resultado = document.getElementById('resultado');
    const emojis = document.querySelectorAll('.emoji');
    const zonaCarrera = document.getElementById('zonaCarrera');
    const eleccion = document.getElementById('eleccion');
    const instrucciones = document.getElementById('instrucciones');
    const textoEleccion = document.getElementById('textoEleccion');

    const sonidoGanar = document.getElementById('sonidoGanar');
    const sonidoPerder = document.getElementById('sonidoPerder');
    const sonidoInicio = document.getElementById('sonidoInicio');
    const sonidoCarrera = document.getElementById('sonidoCarrera');

    let apuesta = null;

    botones.forEach(btn => {
      btn.addEventListener('click', () => {
        apuesta = btn.dataset.emoji;
        apuestaSeleccionada.textContent = `Has apostado por: ${apuesta}`;
      });
    });

    iniciar.addEventListener('click', () => {
      if (!apuesta) {
        alert("Â¡Debes elegir un emoji primero!");
        return;
      }

      eleccion.style.display = 'none';
      instrucciones.style.display = 'none';
      textoEleccion.style.display = 'none';
      zonaCarrera.style.display = 'block';

      emojis.forEach(e => e.style.left = '0px');

      sonidoInicio.play();
      setTimeout(() => {
        sonidoCarrera.play();
        correrCarrera();
      }, 800); // espera que termine el sonido de inicio
    });

    reiniciar.addEventListener('click', () => {
      apuesta = null;
      apuestaSeleccionada.textContent = '';
      resultado.textContent = '';
      zonaCarrera.style.display = 'none';
      eleccion.style.display = 'block';
      instrucciones.style.display = 'block';
      textoEleccion.style.display = 'block';
      reiniciar.style.display = 'none';
    });

    function correrCarrera() {
      const meta = document.querySelector('.pista').offsetWidth - 50;
      const posiciones = {};
      emojis.forEach(e => posiciones[e.dataset.emoji] = 0);

      function mover() {
        let hayGanador = false;

        emojis.forEach(e => {
          const id = e.dataset.emoji;
          const avance = Math.random() * 5 + 1;
          posiciones[id] += avance;
          e.style.left = posiciones[id] + 'px';

          if (posiciones[id] >= meta && !hayGanador) {
            hayGanador = true;
            sonidoCarrera.pause();
            sonidoCarrera.currentTime = 0;

            let ganador = id;

            // 30% chance de forzar victoria del usuario
            if (apuesta && Math.random() < 0.3) {
              ganador = apuesta;
            }

            const gano = ganador === apuesta;
            const mensaje = gano
              ? `ğŸ‰ Â¡Ganaste! El emoji ${ganador} fue el ganador.`
              : `ğŸ˜¢ Perdiste. El emoji ${ganador} ganÃ³ la carrera.`;

            resultado.textContent = mensaje;
            <!-- alert(mensaje); -->

            if (gano) {
              sonidoGanar.play();
            } else {
              sonidoPerder.play();
            }

            reiniciar.style.display = 'inline-block';
          }
        });

        if (!hayGanador) {
          requestAnimationFrame(mover);
        }
      }

      mover();
    }
  </script>
</body>
</html>
