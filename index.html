<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>La Super Carrera de Edwin</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }

    .instrucciones {
      background-color: #ffeb3b;
      padding: 12px;
      margin-bottom: 20px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      color: #333;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    @media (max-width: 600px) {
      .instrucciones {
        font-size: 14px;
      }
    }

    .pista {
      position: relative;
      height: 60px;
      margin: 10px 0;
      background: #f0f0f0;
      border: 1px solid #ccc;
    }

    .emoji {
      position: absolute;
      font-size: 40px;
      top: 10px;
      left: 0px;
    }

    .controles {
      margin: 20px 0;
    }

    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 24px;
      cursor: pointer;
    }

    #resultado {
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
    }

    #apuestaSeleccionada {
      font-size: 18px;
      font-weight: normal;
      color: #555;
    }

    #zonaCarrera {
      display: none;
    }

    #reiniciarCarrera {
      display: none;
    }
  </style>
</head>
<body>

  <div class="instrucciones" id="instrucciones">
    <p>🚨 <strong>Instrucciones del Juego:</strong> 🚨</p>
    <p>1. Elige un emoji de la lista de abajo como tu apuesta. <br> 
       2. Haz clic en "Iniciar Carrera" para que los emojis compitan. <br> 
       3. ¡El primer emoji que cruce la meta gana! 🎉<br> 
       4. El primero en enviar una captura de pantalla de su victoria recibirá un premio de <strong>Q200</strong>. 📸💰
    </p>
  </div>

  <h1>🏁 La Super Carrera de Edwin</h1>
  <p id="textoInicial">Elige un emoji para apostar y luego inicia la carrera.</p>

  <div id="eleccion">
    <div class="controles">
      <span>Tu apuesta:</span><br>
      <button data-emoji="🐢">🐢</button>
      <button data-emoji="🐇">🐇</button>
      <button data-emoji="🦄">🦄</button>
      <button data-emoji="🐶">🐶</button>
      <button data-emoji="🐙">🐙</button>
      <button data-emoji="🦁">🦁</button>
      <button data-emoji="🐵">🐵</button>
    </div>

    <div id="apuestaSeleccionada"></div>
    <button id="iniciarCarrera">Iniciar Carrera</button>
  </div>

  <div id="zonaCarrera">
    <div class="pista"><div class="emoji" data-emoji="🐢">🐢</div></div>
    <div class="pista"><div class="emoji" data-emoji="🐇">🐇</div></div>
    <div class="pista"><div class="emoji" data-emoji="🦄">🦄</div></div>
    <div class="pista"><div class="emoji" data-emoji="🐶">🐶</div></div>
    <div class="pista"><div class="emoji" data-emoji="🐙">🐙</div></div>
    <div class="pista"><div class="emoji" data-emoji="🦁">🦁</div></div>
    <div class="pista"><div class="emoji" data-emoji="🐵">🐵</div></div>
  </div>

  <div id="resultado"></div>
  <button id="reiniciarCarrera">Reiniciar Carrera</button>

  <script>
    const botones = document.querySelectorAll('[data-emoji]');
    const botonInicio = document.getElementById('iniciarCarrera');
    const botonReiniciar = document.getElementById('reiniciarCarrera');
    const resultado = document.getElementById('resultado');
    const apuestaSeleccionada = document.getElementById('apuestaSeleccionada');
    const emojis = document.querySelectorAll('.emoji');
    const zonaCarrera = document.getElementById('zonaCarrera');
    const eleccion = document.getElementById('eleccion');
    const instrucciones = document.getElementById('instrucciones');
    const textoInicial = document.getElementById('textoInicial');

    let apuesta = null;
    let corriendo = false;
    let finalizados = [];

    botones.forEach(btn => {
      btn.addEventListener('click', () => {
        apuesta = btn.getAttribute('data-emoji');
        apuestaSeleccionada.textContent = `Has apostado por: ${apuesta}`;
        apuestaSeleccionada.style.color = 'black';
      });
    });

    botonInicio.addEventListener('click', () => {
      if (!apuesta) {
        alert('¡Primero debes elegir un emoji!');
        return;
      }

      corriendo = true;
      finalizados = [];
      resultado.textContent = '';
      emojis.forEach(emoji => {
        emoji.style.left = '0px';
      });

      instrucciones.style.display = 'none';
      textoInicial.style.display = 'none';
      eleccion.style.display = 'none';
      zonaCarrera.style.display = 'block';
      resultado.style.display = 'none';

      botones.forEach(btn => {
        btn.disabled = true;
      });

      iniciarCarrera();
    });

    botonReiniciar.addEventListener('click', () => {
      corriendo = false;
      finalizados = [];
      resultado.textContent = '';
      apuesta = null;
      apuestaSeleccionada.textContent = '';

      instrucciones.style.display = 'block';
      textoInicial.style.display = 'block';
      eleccion.style.display = 'block';
      zonaCarrera.style.display = 'none';

      botones.forEach(btn => {
        btn.disabled = false;
      });

      botonReiniciar.style.display = 'none';
      botonInicio.style.display = 'inline-block';
    });

    function iniciarCarrera() {
      const anchoPista = document.querySelector('.pista').clientWidth;
      const meta = anchoPista - 50;

      const posiciones = {};
      emojis.forEach(emoji => {
        posiciones[emoji.dataset.emoji] = 0;
      });

      function paso() {
        if (!corriendo) return;

        emojis.forEach(emoji => {
          const id = emoji.dataset.emoji;
          if (finalizados.includes(id)) return;

          const velocidad = Math.random() * 4 + 1;
          posiciones[id] += velocidad;
          emoji.style.left = posiciones[id] + 'px';

          if (posiciones[id] >= meta) {
            finalizados.push(id);
            if (finalizados.length === 1) {
              corriendo = false;
              mostrarGanador(id);
            }
          }
        });

        if (corriendo) {
          requestAnimationFrame(paso);
        }
      }

      requestAnimationFrame(paso);
    }

    function mostrarGanador(ganador) {
      if (ganador === apuesta) {
        resultado.textContent = `🎉 ¡Ganaste! ${ganador} fue el primero en llegar.`;
        resultado.style.color = 'green';
        alert(`¡Ganaste! ${ganador} fue el primero en llegar.`);
      } else {
        resultado.textContent = `😢 Perdiste. ${ganador} ganó la carrera.`;
        resultado.style.color = 'red';
        alert(`Perdiste. ${ganador} ganó la carrera.`);
      }

      botonReiniciar.style.display = 'inline-block';
      botonInicio.style.display = 'none';

      botones.forEach(btn => {
        btn.disabled = true;
      });
    }
  </script>
</body>
</html>
